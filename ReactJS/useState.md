# useState

state : ì»´í¬ë„ŒíŠ¸ê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ìƒíƒœì´ë‹¤. <br/>
useState : ì»´í¬ë„ŒíŠ¸ ìƒíƒœë¥¼ ê°„í¸í•˜ê²Œ ìƒì„±, ì—…ë°ì´íŠ¸í•˜ê²Œ í•´ì¤€ë‹¤.

- useStateì˜ ì´ˆê¸°ê°’ì— ì•„ë¬´ê°’ì„ ë„˜ê²¨ì£¼ì§€ ì•Šìœ¼ë©´ undefined

### ì™œ stateë¥¼ ì§ì ‘ ë°”ê¾¸ì§€ ì•Šê³  useStateë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”?

> **ğŸ’¡ ë©´ì ‘ì„ ìœ„í•œ quick answer :** stateëŠ” ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ì— ì˜í–¥ì„ ì£¼ëŠ” ë°ì´í„°ë¥¼ ê°–ê³  ìˆëŠ” ê°ì²´ì¸ë°,
> ì´ê²ƒì„ ì—…ë°ì´íŠ¸ í•˜ê¸° ìœ„í•´ì„œëŠ” setState, useStateê°€ í•„ìš”í•˜ë‹¤.
> ì§ì ‘ stateë¥¼ ìˆ˜ì •í•˜ë©´ ë¦¬ì•¡íŠ¸ëŠ” renderí•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì•„ì„œ ë Œë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•Šê³  setStateë¥¼ í˜¸ì¶œí•˜ì—¬ stateë¥¼ ë³€ê²½í•˜ë©´ ë¦¬ì•¡íŠ¸ ì—”ì§„ì´ renderí•¨ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ë Œë”ë§ì„ ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

```jsx
function Component() {
  let state = 'hello';

  function handleBtnClick() {
    state = 'hayeong';
  }

  return (
    <>
      <h1>{state}</h1>
      <button onClick={handleBtnClick}>ëˆŒëŸ¬ë´~</button>
    </>
  );
}
```

ë¦¬ì•¡íŠ¸ì—ì„œ ë Œë”ë§ì€ í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì˜ return ê³¼ í´ë˜ìŠ¤í˜• ì»´í¬ë„ŒíŠ¸ì˜ render í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œ ë‹¤ìŒ, ì´ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì´ì „ì˜ ë¦¬ì•¡íŠ¸ íŠ¸ë¦¬ì™€ ë¹„êµí•´ ë¦¬ë Œë”ë§ì´ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸í•´ ì´ë¤„ì§„ë‹¤.
ìœ„ ì½”ë“œì—ì„œëŠ” ë¦¬ë Œë”ë§ì„ ë°œìƒì‹œí‚¤ê¸° ìœ„í•œ ì¡°ê±´ì„ ì¶©ì¡±í•˜ì§€ ëª»í•˜ê³  ìˆë‹¤.

### ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”(lazy initialization)

useStateì˜ ì¸ìˆ˜ë¡œ íŠ¹ì •í•œ ê°’ì„ ë„˜ê¸°ëŠ” í•¨ìˆ˜ë¥¼ ì¸ìˆ˜ë¡œ ë„£ì–´ì¤„ ìˆ˜ë„ ìˆë‹¤. ì´ê²ƒì„ ê²Œìœ¼ë¥¸ ì´ˆê¸°í™”ë¼ê³  í•œë‹¤.
ê²Œìœ¼ë¥¸ ì´ˆê¸°í™” í•¨ìˆ˜ëŠ” ì˜¤ë¡œì§€ stateê°€ ì²˜ìŒ ë§Œë“¤ì–´ì§ˆ ë•Œë§Œ ì‚¬ìš©ëœë‹¤. ë§Œì•½ ì´í›„ ë¦¬ë Œë”ë§ì´ ë°œìƒëœë‹¤ë©´ ì´ í•¨ìˆ˜ì˜ ì‹¤í–‰ì€ ë¬´ì‹œëœë‹¤.

ë§Œì•½ `Number.parseInt(window.localStorage.getItem(cacheKey))`ì™€ ê°™ì´ í•œ ë²ˆ ì‹¤í–‰ë˜ëŠ” ë° ì–´ëŠì •ë„ ë¹„ìš©ì´ ë“œëŠ” ê°’ì´ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. useStateì˜ ì¸ìˆ˜ë¡œ ì´ ê°’ ìì²¼ ì‚¬ìš©í•œë‹¤ë©´ ë§¤ë²ˆ ë Œë”ë§ ì‹œ í•´ë‹¹ ê°’ì— ì ‘ê·¼í•´ì„œ ë‚­ë¹„ê°€ ë°œìƒí•œë‹¤. ë”°ë¼ì„œ ì´ëŸ° ê²½ìš° í•¨ìˆ˜ í˜•íƒœë¡œ ì¸ìˆ˜ì— ë„˜ê²¨ì£¼ëŠ” ê²ƒì´ ê²½ì œì ì´ë‹¤. **ì´ˆê¸°ê°’ì´ ì—†ë‹¤ë©´ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•´ ë¬´ê±°ìš´ ì—°ì‚°ì„ ì‹œë„í•  ê²ƒì´ê³ , ì´ë¯¸ ì´ˆê¸°ê°’ì´ ì¡´ì¬í•œë‹¤ë©´ í•¨ìˆ˜ ì‹¤í–‰ì„ í•˜ì§€ ì•Šê³  ê¸°ì¡´ ê°’ì„ ì‚¬ìš©í•  ê²ƒì´ë‹¤.**

- ê²Œìœ¼ë¥¸ ì´ˆê¸°í™” ì“°ëŠ” ê²½ìš° : ë¬´ê±°ìš´ ì—°ì‚°ì´ ìš”êµ¬ë  ë•Œ ì‚¬ìš©
  - localStorageë‚˜ sessionStorageì— ëŒ€í•œ ì ‘ê·¼
  - map, filter, findê°™ì€ ë°°ì—´ì— ëŒ€í•œ ì ‘ê·¼
  - ì´ˆê¹ƒê°’ ê³„ì‚°ì„ ìœ„í•´ í•¨ìˆ˜ í˜¸ì¶œì´ í•„ìš”í•  ë•Œì™€ ê°™ì´ ë¬´ê±°ìš´ ì—°ì‚°ì„ í¬í•¨í•´ ì‹¤í–‰ ë¹„ìš©ì´ ë§ì´ ë“œëŠ” ê²½ìš°

### setState()ë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ë Œë”ë§ë˜ë‚˜ìš”?

> **ğŸ’¡ ë©´ì ‘ì„ ìœ„í•œ quick answer :** ê°’ì´ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë©´ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. ê°’ì„ ë°”ê¿”ì•¼ ë¦¬ë Œë”ë§ì´ ì¼ì–´ë‚œë‹¤.

### ì•„ë˜ì™€ ê°™ì€ ì½”ë“œì¼ ë•Œ countê°€ í•œ ë²ˆì— 5ì”© ëŠ˜ì–´ë‚  ê²ƒ ê°™ì€ë°, ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ì‘ë™í•˜ë„¤ìš”. ì™œ ê·¸ëŸ´ê¹Œìš”?

> **ğŸ’¡ ë©´ì ‘ì„ ìœ„í•œ quick answer :** setStateëŠ” ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ë°©ì§€í•˜ë©´ì„œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì¦‰ì‹œ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•Šë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤. ì´ëŸ¬í•œ ì‘ë™ ë°©ì‹ì€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•œë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. ì˜ë„ëŒ€ë¡œ 5ì”© ì˜¬ë¼ê°€ê²Œ í•˜ë ¤ë©´, prevë¼ëŠ” ì„ì‹œ ì €ì¥ ê³µê°„ì„ ì‚¬ìš©í•´ ì‘ì„±í•´ì•¼ í•œë‹¤. í•œ ë§ˆë””ë¡œ ì¼ì • ì‹œê°„ë™ì•ˆ ë³€í™”í•˜ëŠ” ìƒíƒœë¥¼ ëª¨ì•„ í•œ ë²ˆì— ë Œë”ë§ í•˜ê¸° ìœ„í•´ì„œì´ë‹¤. ê²°êµ­, ì›¹ í˜ì´ì§€ë¥¼ ë¶ˆí•„ìš”í•œ ë Œë”ë§ íšŸìˆ˜ë¥¼ ì¤„ì–´ ì¢€ ë” ë¹ ë¥¸ ì†ë„ë¡œ ë™ì‘í•˜ê²Œ ë§Œë“¤ê¸° ìœ„í•´ì„œì´ë‹¤.

```JavaScript
function onClickCountUp() {
   setCount(count + 1); // stateëŠ” ë¦¬ì•¡íŠ¸ htmlì—ì„œ ë³€ê²½ì„ ê°ì§€í•¨(ì¦‰, document.get... í•„ìš”ì—†ìŒ)
   setCount(count + 1);
   setCount(count + 1);
   setCount(count + 1);
   setCount(count + 1);
}
// ì´ í•¨ìˆ˜ë¥¼ í´ë¦­ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ë¡œ ë‹¬ë©´ 5ì”© ì˜¬ë¼ê°€ëŠê²Œ ì•„ë‹ˆë¼ 1ì”© ì˜¬ë¼ê°
```

setStateëŠ” ë¶ˆí•„ìš”í•œ ë Œë”ë§ì„ ë°©ì§€í•˜ë©´ì„œ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì¦‰ì‹œ í•¨ìˆ˜ë¥¼ ìˆ˜í–‰í•˜ì§€ ì•Šë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤. ì´ëŸ¬í•œ ì‘ë™ ë°©ì‹ì€ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë™í•œë‹¤ê³  í•  ìˆ˜ ìˆë‹¤. ì˜ë„ëŒ€ë¡œ 5ì”© ì˜¬ë¼ê°€ê²Œ í•˜ë ¤ë©´, prevë¼ëŠ” ì„ì‹œ ì €ì¥ ê³µê°„ì„ ì‚¬ìš©í•´ ì‘ì„±í•´ì•¼ í•œë‹¤.

```JavaScript
function onClickCountUp() {
    setCount((prev) => prev + 1);
    setCount((prev) => prev + 1);
    setCount((prev) => prev + 1);
    setCount((prev) => prev + 1);
}
```

ì´ë ‡ê²Œ prevë¥¼ ì‚¬ìš©í•˜ë©´ ì„ì‹œ ì €ì¥ ê³µê°„ì— ìˆëŠ” ê°’ì„ ë¨¼ì € êº¼ë‚´ì˜¤ê³ , ë§Œì•½ ì„ì‹œ ì €ì¥ ê³µê°„ì— ìˆëŠ” ê°’ì´ ì—†ë‹¤ë©´ ê¸°ë³¸ ê°’ì„ ë¶ˆëŸ¬ì˜¤ê²Œ ëœë‹¤.

### useState ë‚´ë¶€ì˜ ëª¨ìŠµì„ êµ¬í˜„í•œ ëª¨ìŠµ (from. ëª¨ë˜ ë¦¬ì•¡íŠ¸ deep dive)

```jsx
const MyReact = function () {
  const global = {};
  let index = 0;

  function useState(initialState) {
    if (!global.states) {
      // ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì˜ states ë°°ì—´ì„ ì´ˆê¸°í™”í•œë‹¤.
      // ìµœì´ˆ ì ‘ê·¼ì´ë¼ë©´ ë¹ˆ ë°°ì—´ë¡œ ì´ˆê¸°í™”í•œë‹¤.
      global.states = [];
    }

    // states ì •ë³´ë¥¼ ì¡°íšŒí•´ì„œ í˜„ì¬ ìƒíƒœê°’ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³ ,
    // ì—†ë‹¤ë©´ ì´ˆê¹ƒê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤.
    const currentState = global.states[index] || initialState;
    // statesì˜ ê°’ì„ ìœ„ì—ì„œ ì¡°íšŒí•œ í˜„ì¬ ê°’ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•œë‹¤.
    global.states[index] = currentState;

    // ì¦‰ì‹œ ì‹¤í–‰ í•¨ìˆ˜ë¡œ setterë¥¼ ë§Œë“ ë‹¤.
    const setState = (function () {
      // í˜„ì¬ indexë¥¼ í´ë¡œì €ë¡œ ê°€ë‘¬ë†”ì„œ ì´í›„ì—ë„ ê³„ì†í•´ì„œ ë™ì¼í•œ indexì—
      // ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.
      let currentIndex = index;
      return function (value) {
        global.states[currentIndex] = value;
        // ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•œë‹¤. ì‹¤ì œë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•˜ëŠ” ì½”ë“œëŠ” ìƒëµí–ˆë‹¤.
      };
    })();
    // useStateë¥¼ ì“¸ ë•Œë§ˆë‹¤ indexë¥¼ í•˜ë‚˜ì”© ì¶”ê°€í•œë‹¤. ì´ indexëŠ” setStateì—ì„œ ì‚¬ìš©ëœë‹¤.
    // ì¦‰, í•˜ë‚˜ì˜ stateë§ˆë‹¤ indexê°€ í• ë‹¹ë¼ ìˆì–´ ê·¸ indexê°€ ë°°ì—´ì˜ ê°’(global.states)ì„
    // ê°€ë¦¬í‚¤ê³  í•„ìš”í•  ë•Œë§ˆë‹¤ ê·¸ ê°’ì„ ê°€ì ¸ì˜¤ê²Œ í•œë‹¤.
    index = index + 1;

    return [currentState, setState];
  }

  // ì‹¤ì œ useStateë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸
  function ì»´í¬ë„ŒíŠ¸() {
    const [value, setValue] = useState(0);

    // ..
  }
};
```

useStateëŠ” í´ë¡œì €ì— ì˜ì¡´í•´ êµ¬í˜„ë¼ ìˆì„ ê²ƒì´ë‹¤. í´ë¡œì €ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ì™¸ë¶€ì— í•´ë‹¹ ê°’ì„ ë…¸ì¶œì‹œí‚¤ì§€ ì•Šê³  ì˜¤ì§ ë¦¬ì•¡íŠ¸ì—ì„œë§Œ ì“¸ ìˆ˜ ìˆì—ˆê³ , í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ê°€ ë§¤ë²ˆ ì‹¤í–‰ë˜ë”ë¼ë„ useStateì—ì„œ ì´ì „ì˜ ê°’ì„ ì •í™•í•˜ê²Œ êº¼ë‚´ ì“¸ ìˆ˜ ìˆê²Œ ëë‹¤.
